<!--
=========================================================
Material Kit - v2.0.7
=========================================================

Product Page: https://www.creative-tim.com/product/material-kit
Copyright 2020 Creative Tim (https://www.creative-tim.com/)

Coded by Creative Tim

=========================================================

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../../assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="../../assets/img/favicon.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>
        空汙查詢精靈
    </title>
    <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' station='viewport' />
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="../../assets/css/material-kit.css?v=2.0.7" rel="stylesheet" />
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="../../assets/demo/demo.css" rel="stylesheet" />
    <style type="text/css">
        .card .card-header-secondary,
        .card.bg-info,
        .card.card-rotate.bg-info .front,
        .card.card-rotate.bg-info .back {
            background: linear-gradient(60deg, #292d2e, #424444);
        }
    </style>
</head>

<body class="landing-page sidebar-collapse">
    <nav class="navbar navbar-transparent navbar-color-on-scroll fixed-top navbar-expand-lg" color-on-scroll="100" id="sectionsNav">
        <div class="container">
            <div class="navbar-translate">
                <a class="navbar-brand" href="../../index.html">
                   Air Pollute Index</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="../../index.html" class="nav-link">
                            <i class="material-icons">assignment_ind</i> 首頁
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../../Timeline/index.html" class="nav-link">
                            <i class="material-icons">timeline</i> 學經歷
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../../blog/" class="nav-link">
                            <i class="material-icons">description</i> 部落格
                        </a>
                    </li>
                    <li class="dropdown nav-item active">
                        <a href="#" class="dropdown-toggle nav-link " data-toggle="dropdown">
                            <i class="material-icons">account_tree</i> 作品集
                        </a>
                        <div class="dropdown-menu dropdown-with-icons">
                            <a href="../../Projects/google_assistant/index.html" class="dropdown-item">
                                <span class="iconify" data-icon="mdi-google-assistant" data-inline="false"></span>&emsp;Google助理語音應用
                            </a>
                            <a href="../../Projects/npm/index.html" class="dropdown-item">
                                <span class="iconify" data-icon="simple-icons:npm" data-inline="false"></span>&emsp;Node.js 模組
                            </a>
                            <a href="../../Projects/python/index.html" class="dropdown-item">
                                <span class="iconify" data-icon="simple-icons:python" data-inline="false"></span>&emsp;Python學習紀錄
                            </a>
                            <a href="../../Projects/tw_air_pollute/index.html" class="dropdown-item active">
                                <span class="iconify" data-icon="oi-cloud" data-inline="false"></span>&emsp;空汙即時查詢
                            </a>

                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" rel="tooltip" title="" data-placement="bottom" href="https://www.facebook.com/profile.php?id=100000555093316" target="_blank" data-original-title="Facebook" rel="nofollow">
                            <i class="fa fa-facebook"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" rel="tooltip" title="" data-placement="bottom" href="https://www.linkedin.com/in/%E7%B4%B9%E5%AE%8F-%E6%B8%B8-74679110b/" target="_blank" data-original-title="LinkedIn" rel="nofollow">
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" rel="tooltip" title="" data-placement="bottom" href="https://github.com/hank199599" target="_blank" data-original-title="Github" rel="nofollow">
                            <i class="fa fa-github"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" rel="tooltip" title="" data-placement="bottom" href="https://open.spotify.com/user/11141875107?si=-Yre6oNIQTOOmtOzuDY0IQ" target="_blank" data-original-title="Spotify" rel="nofollow">
                            <i class="fa fa-spotify"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="page-header header-filter" data-parallax="true" style="background-image: url('../../assets/img/air_pollute.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-md-6" id="weather_report">
                    <h1 class="title">現在天氣概況</h1>
                    <h4>資料獲取中...</h4>
                </div>
            </div>
        </div>
    </div>
    <div class="main main-raised">
        <div class="container">
            <div class="section text-center">
                <div class="container">
                    <div class="card card-nav-tabs card-plain">
                        <div class="card-header card-header-secondary">
                            <!-- colors: "header-primary", "header-info", "header-success", "header-warning", "header-danger" -->
                            <div class="nav-tabs-navigation">
                                <div class="nav-tabs-wrapper">
                                    <ul class="nav nav-tabs" data-tabs="tabs" id="county_list">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="card-body ">
                            <div class="tab-content text-center" id="county_content">
                                <div class="tab-pane active" id="臺北市">
                                    <div class="col-md-3 ml-auto mr-auto">
                                        <div class="card">
                                            <div class="card-body" style="padding: 0;">
                                                <img class="card-img-top" src="https://dummyimage.com/1933x1068/232830/ffffff.png&text=NaN" rel="nofollow" alt="Card image cap">
                                                <div class="card-body">
                                                    <p class="card-text">
                                                        <h3 class="card-title" style="margin: 0 0 "> station </h3>
                                                        <h2 class="card-text" style="margin: 0 0 "><small class="text-muted"> status_generator(data.AQI) </small></h2>
                                                        <h7 class="card-text"> info_output_generator(data.AQI) </h7>
                                                    </p>
                                                    <a href="# station " data-toggle="modal">詳細資訊</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>;
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section section-contacts">
            <div class="row">
                <div class="col-md-8 ml-auto mr-auto">

                </div>
            </div>
        </div>
    </div>
    </div>
    <footer class="footer footer-default">
        <div class="container">
            <nav class="float-left">
                <ul>
                    <li>
                        <a href="https://www.facebook.com/profile.php?id=100000555093316" target="_blank">Facebook</a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/紹宏-游-74679110b/" target="_blank">LinkedIn</a>
                    </li>
                    <li>
                        <a href="https://github.com/hank199599" target="_blank">Github</a>
                    </li>
                    <li>
                        <a href="mailto:hank199599@gmail.com">Email</a>
                    </li>
                </ul>
            </nav>
            <div class="copyright float-right">
                &copy;
                <script>
                    document.write(new Date().getFullYear())
                </script>, 使用由
                <a href="https://www.creative-tim.com/" target="_blank">Creative Tim</a> 提供的設計工具
            </div>

        </div>
    </footer>
    <!--彈跳式視窗擺放處-->
    <div id="modal creator">
        <!--透過程式自動生成內容-->
    </div>

    <!--   Core JS Files   -->
    <script src="../../assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="../../assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="../../assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="../../assets/js/plugins/moment.min.js"></script>
    <!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
    <script src="../../assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="../../assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
    <!--  Google Maps Plugin    -->
    <!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
    <script src="../../assets/js/material-kit.js?v=2.0.7" type="text/javascript"></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-database.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="../../assets/js/material-kit.js?v=2.0.7" type="text/javascript"></script>
    <!--icon挿件 -->
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
    <!--天氣資訊讀取套件 -->
    <script src="./fetch.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyD7QTtDBeC-O0tjPGfr6HjO-tK3Qz8J_L0",
            authDomain: "b1a2b-krmfch.firebaseapp.com",
            databaseURL: "https://b1a2b-krmfch.firebaseio.com",
            projectId: "b1a2b-krmfch",
            storageBucket: "b1a2b-krmfch.appspot.com",
            messagingSenderId: "777443303063",
            appId: "1:777443303063:web:ad45bae1d1dd1f85ded3d2"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var database = firebase.database();
        var test_list = {
            "臺北市": ["士林", "大同", "中山", "古亭", "松山", "陽明", "萬華"],
            "基隆市": ["基隆"],
            "新北市": ["三重", "土城", "永和", "汐止", "板橋", "林口", "淡水", "富貴角", "菜寮", "新店", "新莊", "萬里"],
            "桃園市": ["大園", "中壢", "平鎮", "桃園", "龍潭", "觀音"],
            "新竹縣市": ["新竹", "竹東", "湖口"],
            "苗栗縣": ["三義", "苗栗", "頭份"],
            "臺中市": ["大里", "西屯", "沙鹿", "忠明", "豐原"],
            "彰化縣": ["二林", "彰化", "線西", "大城"],
            "南投縣": ["竹山", "南投", "埔里"],
            "雲林縣": ["斗六", "崙背", "麥寮", "臺西"],
            "嘉義縣市": ["嘉義", "朴子", "新港"],
            "臺南市": ["安南", "善化", "新營", "臺南"],
            "高雄市": ["美濃", "橋頭", "楠梓", "仁武", "左營", "前金", "鳳山", "復興", "前鎮", "小港", "大寮", "林園"],
            "屏東縣": ["屏東", "恆春", "潮州"],
            "宜蘭縣": ["冬山", "宜蘭"],
            "花蓮縣": ["花蓮"],
            "臺東縣": ["臺東", "關山"],
            "離島地區": ["金門", "馬公", "馬祖"]
        };
        var tab_list = {
            "臺北市": "Taipei",
            "基隆市": "Keelung",
            "新北市": "New_Taipei",
            "桃園市": "Taoyuan",
            "新竹縣市": "Hsinchu",
            "苗栗縣": "Miaoli",
            "臺中市": "Taichung",
            "彰化縣": "Changhua",
            "南投縣": "Nantou",
            "雲林縣": "Yunlin",
            "嘉義縣市": "Chiayi",
            "臺南市": "Tainan ",
            "高雄市": "Kaohsiung ",
            "屏東縣": "Pingtung ",
            "宜蘭縣": "Yilan",
            "花蓮縣": "Hualien",
            "臺東縣": "Taitung",
            "離島地區": "Outlying_islands"
        }
        var county_list = Object.keys(test_list);
        var nav_items = '';
        var nav_content = '';
        var modal_content = '';
        for (var i = 0; i < county_list.length; i++) {
            nav_items = nav_items + '<li class="nav-item';
            nav_content = nav_content + '<div class="tab-pane';
            if (i === 0) {
                nav_items = nav_items + ' active'
                nav_content = nav_content + ' active'
            }
            nav_items = nav_items + '" > <a class="nav-link" href="#' + tab_list[county_list[i]] + '" data-toggle="tab">' + county_list[i] + '</a></li>'
            nav_content = nav_content + '" id="' + tab_list[county_list[i]] + '">' + '<p></p></div>'
        }
        document.getElementById('county_list').innerHTML = nav_items
        document.getElementById('county_content').innerHTML = nav_content

        var myData = firebase.database().ref('/TWair');

        myData.once('value', function(snapshot) {

            var snapshot_data = snapshot.val();

            document.getElementById("weather_report").innerHTML = '<h1 class="title">現在天氣概況</h1><h4>' + snapshot_data.report + "<br><br> 更新時間 •  <b>" + FormatTime() + '</b></h4>';

            var mobile_array = machine(Object.keys(snapshot_data.data))

            for (var i = 0; i < county_list.length; i++) {
                var station_array = test_list[county_list[i]];
                var content = '';
                station_array = station_array.concat(matcher(county_list[i], mobile_array))

                for (var j = 0; j < station_array.length; j++) {
                    var station = station_array[j];
                    var data = snapshot_data.data[station];

                    if (station.indexOf('(') !== -1) {
                        station = station.split('(')[1].replace(')', '(行動站)')
                    }

                    content = content +
                        '<div class="col-md-3 ml-auto mr-auto">' +
                        '<div class="card">' +
                        '<div class="card-body" style="padding: 0;">' +
                        '<img class="card-img-top" src="' + picture_generator(data.AQI) + '" rel="nofollow" alt="Card image cap">' +
                        ' <div class = "card-body" >' +
                        '<p class = "card-text">' +
                        '<h3 class="card-title" style="margin: 0 0 ">' + station + '</h3>' +
                        '<h2 class="card-text"  style="margin: 0 0 "><small class="text-muted">' + status_generator(data.AQI) + '</small></h2>' +
                        '<h7 class="card-text">' + info_output_generator(data.AQI) + '</h7>' +
                        '</p>' +
                        '<a href="#' + station + '"  data-toggle="modal" >詳細資訊</a>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>';
                    modal_content = modal_content +
                        '<div class="modal fade" id="' + station + '" tabindex="-1" role="dialog">' +
                        '<div class="modal-dialog modal-dialog-centered" role="document">' +
                        '<div class="modal-content">' +
                        '<div class="modal-header">' +
                        '<button type="button" class="close" data-dismiss="modal" aria-label="Close">' +
                        '<i class="material-icons">clear</i>' +
                        '</button>' +
                        '</div>' +
                        '<div class="modal-body" style="padding-top: 0;">' +
                        '<h2  style="margin: 0 0 ">' + station + '</h2>' +
                        '<h3 class="card-text"  style="margin: 0 0 "><small class="text-muted">' + status_generator(data.AQI) + '</small></h3>' +
                        '<p class="card-text">' + info_generator(data.AQI) + '</p>' +
                        '<p class="card-text" style="margin: 0 0 "> PM₁₀ ' + data.PM10 + '(μg/m³) • PM₂.₅ ' + data.PM25 + '(μg/m³) • 臭氧 ' + data.O3 + '(ppb) </p>' +
                        '</div>' +
                        '<div class="modal-footer">' +
                        '<button type="button" class="btn btn-danger btn-link" data-dismiss="modal">Close</button>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>'
                }

                document.getElementById(tab_list[county_list[i]]).innerHTML = '<div class="row">' + content + '</div>'
            }

            document.getElementById('modal creator').innerHTML = modal_content
        })
    </script>
</body>

</html>